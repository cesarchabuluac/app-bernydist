var DOMINIO="berny.mx",current_brand_url="todos",current_division_url="todos",current_group_url="todos",current_category_url="todos",current_product_url="",current_page=1,current_baseurl="catalogo/",current_fullurl=current_baseurl,total_items=0,total_price=0;function ResC(t,r){var a="0123456789",e="-0123456789",o=" abcdefghijklmnñopqrstuvwxyzABCDEFGHIJKLMNÑOPQRSTUVWXYZ",n=[8,37,46,39];switch(r){case"num":r=a;break;case"car":r=o;break;case"num_car":r="0123456789 abcdefghijklmnñopqrstuvwxyzABCDEFGHIJKLMNÑOPQRSTUVWXYZ";break;case"date":case"hr":r=e;break;case"monto":r=".0123456789"}var i,t=t||window.event,l=t.charCode||t.keyCode,t=String.fromCharCode(l),d=!1;for(i in n)if(l==n[i]){d=!0;break}return-1!=r.indexOf(t)||d}function ValidePromo(categoria){$.post("spages/ofertas",{categoria:categoria},function(data){if(-1<data.indexOf("html"))return!1;var c=eval(data);for(x=0;x<c.length;x++)for(var IDVID=c[x].datos,v=Array(),t=0,v=IDVID.split(","),t=0;t<v.length-1;t++){var categoria=v[t];$("#CATE"+categoria).html("<img alt='balazo3' src='assets/img/balazo3.png' class='' style=' width:35px; height:35px; border-bottom: 1px solid #f1f1f1;'> ")}})}function ValidePromoxArticulo(clave_articulo){$.post("spages/ofertasArticuloCliente",{clave_articulo:clave_articulo},function(data0){if(data=data0,!(-1<data.indexOf("DOCTYPE html"))&&0<data.length){var c=eval(data),i=0,j=1;for(x=0;x<c.length;x++)for(var IDVID=c[x].datos,v=Array(),vecto=Array(),t=0,v=IDVID.split(","),t=0;t<v.length-1;t++){var clave_articulo2=v[t],vecto=clave_articulo2.split("|");$("#PROT"+vecto[0]).html("<img alt='gitpeque' src='assets/img/gifpeque.gif' style=' width:25px; height:25px;border-bottom: 1px solid #f1f1f1;'><span style=\"color:#F00;\">"+vecto[1]+"%</span>")}}}),$("#myModalLoading").modal("hide")}$(document).on("ready",function(){function a(t,o){console.log(t);var n="";$("#the-products").html('<div class="thumbnails"></div>'),$.getJSON(t,function(a){var t,r,e;$(".thumbnails").html(""),$.each(a.categories,function(t,r){n=(n=(n=(n=(n=(n=(n=(n=(n=(n='<div class="col-xs-3" title="uploads/categories/{category_id}.jpg"><div id="CATE{category_id}" style="top:10%;left:82%; position:absolute;"></div><a <a data-brand-name="{brand_name}" data-brand-url="{brand_url}" data-division-name="{division_name}" data-division-url="{division_url}" data-group-name="{group_name}" data-group-url="{group_url}" data-category-name="{category_name}" data-category-url="{category_url}" data-sent-where="{sent_where}" title="{category_name}" class="thumbnail" href="categorias_p/{brand_url}/{division_url}/{group_url}/{category_url}"><img alt="{category_id}" src="uploads/categories/{category_id}.jpg" width="210" height="90"><div class="thumb-info"><p class="titulo">{category_name}</p><p><img alt="{brand_id}" src="uploads/marcas/{brand_id}.jpg" style="height:25px;" /></p></div></a></div>').split("{brand_url}").join(r.brand_url)).split("{brand_name}").join(r.brand_name)).split("{division_url}").join(r.division_url)).split("{division_name}").join(r.division_name)).split("{group_url}").join(r.group_url)).split("{group_name}").join(r.group_name)).split("{category_url}").join(r.category_url)).split("{category_id}").join(r.category_id)).split("{category_name}").join(r.category_name),Categories=Categories+r.category_id+",",n=(n=n.replace("{brand_id}",r.brand_id)).replace("{sent_where}",a.sent_where),console.log(a.categories),$(".thumbnails").append(n)}),1==o&&(setTimeout(function(){ValidePromo(Categories)},3e3),t=a.categories_total,r=current_page,e=a.sent_where,$.post("catalogo/pagination/"+current_brand_url+"/"+current_division_url+"/"+current_group_url+"/"+current_category_url+"/"+t+"/16/"+r+"/"+e,function(t){$(".pagination_box").html(t)}),$("#myModalLoading").modal("hide")),$("#myModalLoading").modal("hide")})}function e(){"todos"==current_brand_url?(current_fullurl=current_baseurl,$(".breadcrumbs-brand").html('<a href="categorias_p/">Todas las marcas</a>')):(current_fullurl=current_baseurl+current_brand_url+"/",$(".breadcrumbs-brand").html('<a href="categorias_p/'+current_brand_url+'">'+current_brand_url+"</a>")),"todos"==current_division_url?(current_fullurl+="todos",$(".breadcrumbs-division").html("")):(current_fullurl=current_baseurl+current_brand_url+"/"+current_division_url+"/",$(".breadcrumbs-division").html('&nbsp;/&nbsp;<a href="categorias_p/'+current_brand_url+"/"+current_division_url+'">'+current_division_url+"</a> ")),"todos"==current_group_url?$(".breadcrumbs-group").html(""):$(".breadcrumbs-group").html('&nbsp;/&nbsp;<a href="categorias_p/'+current_brand_url+"/"+current_division_url+"/"+current_group_url+'">'+current_group_url+"</a> "),"todos"==current_category_url?$(".breadcrumbs-category").html(""):$(".breadcrumbs-category").html('&nbsp;/&nbsp;<a href="categorias_p/'+current_brand_url+"/"+current_division_url+"/"+current_group_url+"/"+current_category_url+'">'+current_category_url+"</a>")}$("input:text").focus(function(){$(this).select()}),$("ul.brands > li > a").on("click",function(t){$("#myModalLoading").modal("show"),t.preventDefault(),current_brand_url=$(this).attr("data-brand-url"),current_category_url=current_group_url=current_division_url="todos",e(),current_page=1,$("ul.brands > li").removeClass("open"),$(this).parent().addClass("open"),$("ul.divisions").html(""),t=$(this).attr("data-brand-url"),$("#myModalLoading").modal("show"),$.getJSON("catalogo/json/divisionsByBrand/"+t,function(t){var a;0<t.total&&(a='<ul class="divisions">',$.each(t.divisions,function(t,r){a+='<li><a data-division-name="'+r.division_name+'" data-division-url="'+r.division_url+'" href="catalogo/'+r.brand_url+"/"+r.division_url+'">'+r.division_name+"</a>"}),a+="</ul>",$("ul.divisions").append(a))}),a("catalogo/"+current_brand_url+"/"+current_division_url+"/"+current_group_url+"/"+current_category_url,!0),history.pushState(null,null,"catalogo/"+current_brand_url+"/"+current_division_url+"/"+current_group_url+"/"+current_category_url)}),$("#tree").on("click",".all-products",function(t){$("#myModalLoading").modal("show"),t.preventDefault(),current_group_url=current_category_url=current_division_url="todos",e(),$(".groups").remove(),$(".categories").remove(),$(".divisions>li").removeClass("open"),a("catalogo/"+current_brand_url+"/"+current_division_url+"/"+current_group_url+"/"+current_category_url,!0)}),$("#tree").on("click",".divisions>li>a",function(t){var r;$("#myModalLoading").modal("show"),t.preventDefault(),$(".divisions>li").removeClass("open"),$(".groups").remove(),current_division_url=$(this).attr("data-division-url"),current_category_url=current_group_url="todos",e(),$(this).parent().addClass("open loading"),r=this,$(this).attr("data-division-url"),$.post("catalogo/json/groupsByDivision/"+current_brand_url+"/"+current_division_url,function(t){$(r).parent().removeClass("loading"),$(r).parent().append(t),$("#myModalLoading").modal("hide")}),a("catalogo/"+current_brand_url+"/"+current_division_url+"/"+current_group_url+"/"+current_category_url,!0)}),$("#tree").on("click",".groups>li>a",function(t){var r;$("#myModalLoading").modal("show"),t.preventDefault(),current_group_url=$(this).attr("data-group-url"),current_category_url="todos",$(".breadcrumbs-group").html(' / <a href="">'+current_group_url+"</a>"),$(".breadcrumbs-category").html(""),$(".groups > li").removeClass("open"),$(".categories").remove(),$(this).parent().addClass("open loading"),r=this,$(this).attr("data-group-url"),$.post("catalogo/json/categoriesByGroup/"+current_brand_url+"/"+current_division_url+"/"+current_group_url,function(t){$(r).parent().removeClass("loading"),$(r).parent().append(t),$("#myModalLoading").modal("hide")}),a("catalogo/"+current_brand_url+"/"+current_division_url+"/"+current_group_url+"/"+current_category_url,!0)}),$("#tree").on("click",".categories li a",function(t){$("#myModalLoading").modal("show"),t.preventDefault(),current_category_url=$(this).data("category-url"),e(),$.post($(this).attr("href"),function(t){$("#the-products").html(t),$("#myModalLoading").modal("hide")}),$(".pagination_box").html("")}),$(".pagination_box").on("click","a",function(t){$("#myModalLoading").modal("show"),t.preventDefault(),current_page=$(this).data("page"),$(".pagination_box li").removeClass("disabled"),$(this).parent().addClass("disabled"),a($(this).attr("href"),!0)}),$("#the-products1").on("click",".thumbnail",function(t){$("#myModalLoading").modal("show"),t.preventDefault(),current_category_url=$(this).data("category-url"),current_sent_where=$(this).attr("data-sent-where"),e(),console.log("TEST->catalogo/product_category/"+current_brand_url+"/"+current_division_url+"/"+current_group_url+"/"+current_category_url+"/null/"+current_sent_where),console.log("current_fullurl"+current_fullurl),$.post("catalogo/product_category/"+current_brand_url+"/"+current_division_url+"/"+current_group_url+"/"+current_category_url+"/null/"+current_sent_where,{current_fullurl:current_fullurl},function(t){$("#the-products").html(t),$("#tempclaves")?($("#tempclaves").modal("hide"),ValidePromoxArticulo($("#tempclaves").html())):$("#myModalLoading").modal("hide")}),$(".pagination_box").html(""),history.pushState(null,null,"catalogo/"+current_brand_url+"/"+current_division_url+"/"+current_group_url+"/"+current_category_url+"/null/"+current_sent_where)}),$(".breadcrumb").on("click","a",function(t){$("#myModalLoading").modal("show"),t.preventDefault(),$(this).parent().hasClass("breadcrumbs-group")&&(current_category_url="todos"),$(this).parent().hasClass("breadcrumbs-division")&&(current_category_url=current_group_url="todos"),$(this).parent().hasClass("breadcrumbs-brand")&&(current_category_url=current_group_url=current_division_url="todos"),$(this).parent().hasClass("breadcrumbs-category")||(e(),a("catalogo/",!0))}),$("#the-products").on("click",".next-category",function(t){$("#myModalLoading").modal("show"),t.preventDefault(),$.post($(this).attr("href"),function(t){$("#the-products").html(t),$("#myModalLoading").modal("hide")})}),$("#the-products").on("click",".prev-category",function(t){t.preventDefault(),$("#myModalLoading").modal("show"),$.post($(this).attr("href"),function(t){$("#the-products").html(t),$("#myModalLoading").modal("hide")})}),$("#the-products").on("click","#ir_a_pagina",function(t){current_sent_where=$(this).attr("data-sent-where"),t.preventDefault(),$("#myModalLoading").modal("show"),current_category_url="todos",e(),a("catalogo/"+current_brand_url+"/"+current_division_url+"/"+current_group_url+"/"+current_category_url+"/"+current_page+"/"+current_sent_where,!0)})}),$(".setting-view").on("click",function(t){var r=$(this).data("value");let a=$(this).data("view");("catalog"===a?$("#setting-view-general"):$("#setting-view-catalog")).attr("checked",!1),setCustomerSettingView(r,"setting_view").then(t=>{"catalog"===a?window.location.reload():window.location.href="tienda"}).catch(console.log)}),$("body").on("click",".btn_addToCart",function(){$("#modal-btn-add-to-cart").html("Agregando..."),$("#modal-btn-add-to-cart").addClass("disabled");let r=$("#quantityToAddcategory").val(),a=$("#modalProductCode").val(),e=$("#modalProductId").val();var t=$("#empaqueMinimo").val();let o=parseInt(r)%parseInt(t);var n=$("#modalStorage").val();let i=$("#modalProductName").val(),l=$("#modalProductPrice").val();var d=r%t;if("N"==n&&0==d&&(o=0),0<o)return alert("De este producto solo se puede solicitar multiplos de "+t+". Ejemplo: "+ +t+", "+2*t+", "+3*t+", "+4*t+", "+5*t+" piezas."),$("#quantityToAddcategory").focus().select(),!1;addMyCart(e,r).then(t=>{t.status?($(".total-items").html(t.total_items),$(".total-price").html("$ "+_formatPrice(t.data.total)),$("#quantityToAddcategory").val(1),$("#success-row").removeClass("d-none"),$("#qty-row").addClass("d-none"),"production"===environment&&(gtag("event","add_to_cart",{items:[{id:a,name:i,list_position:1,quantity:r,price:parseFloat(l).toFixed(2)}]}),fbq("track","AddToCart",{content_ids:[a],content_type:"product",content_name:i,value:parseFloat(l.split(",").join("")).toFixed(2),currency:"MXN"})),setTimeout(()=>{$("#btn-quick-purchase-"+e).removeClass("btn-solid-add").addClass("btn-steal-add"),$("#myModal").modal("hide")},700),window.location.reload()):alert(t.message)}).catch(console.log)}),$("body").on("click","#product-btn-add-to-cart",function(){$("#product-btn-add-to-cart").html("Agregando..."),$("#product-btn-add-to-cart").addClass("disabled"),$("#product-btn-add-to-cart").prop("disabled",!0);let r=$("#product-quantity-input").val(),a=$(this).data("code");var t=$(this).data("id"),e=$(this).data("minqty");let o=parseInt(r)%parseInt(e);var n=$(this).data("storage");let i=$(this).data("name"),l=$(this).data("price");var d=r%e;if("N"==n&&0==d&&(o=0),0<o)return alert("De este producto solo se puede solicitar multiplos de "+e+". Ejemplo: "+ +e+", "+2*e+", "+3*e+", "+4*e+", "+5*e+" piezas."),$("#quantityToAddcategory").focus().select(),!1;addMyCart(t,r).then(t=>{t.status?($("#product-btn-add-to-cart").html("Producto agregado"),$("#product-btn-add-to-cart").removeClass("btn-solid"),$("#product-btn-add-to-cart").removeClass("disabled"),$("#product-btn-add-to-cart").addClass("btn-solid-teal"),$("#product-btn-add-to-cart").prop("disabled",!1),$(".total-items").html(t.total_items),$(".total-price").html("$ "+_formatPrice(t.data.total)),$("#keep-buying-btn").removeClass("d-none"),$("#product-quantity-input").val(1),"production"===environment&&(gtag("event","add_to_cart",{items:[{id:a,name:i,list_position:1,quantity:r,price:parseFloat(l).toFixed(2)}]}),fbq("track","AddToCart",{content_ids:[a],content_type:"product",content_name:i,value:parseFloat(l.split(",").join("")).toFixed(2),currency:"MXN"})),window.location.reload()):alert(t.message)}).catch(console.log)}),$("body").on("keypress",".quantityToAdd",function(t){13==t.which&&$(".btn_addToCart").click()}),$("#myModal").on("shown.bs.modal",function(){$(".quantityToAdd").focus().select()}),$(".recently input.quantityToAddcategory").focus(),$("#the-products").on("click",".addToCart",function(t){total_price=total_items=0,$("#modal-btn-add-to-cart").html("Agregar"),$("#modal-btn-add-to-cart").removeClass("disabled"),$("#qty-row").removeClass("d-none"),$("#success-row").addClass("d-none");var r=$(this).data("id"),a=$(this).data("code"),e=$(this).data("name"),o=$(this).data("price"),n=$(this).data("img"),i=$(this).data("minqty"),l=$(this).data("storage"),d=$(this).data("price_list");$("#productTitle").html(e),$("#productUrl").attr("src",n),$("#productModalPrice").html(`<del>$${d}</del><br>$`+o),$("#empaqueMinimo").val(i),$("#modalStorage").val(l),$("#modalProductId").val(r),$("#modalProductCode").val(a),$("#quantityToAddcategory").val(1),$("#modalProductName").val(e),$("#modalProductPrice").val(o),"production"===environment&&(gtag("event","view_item",{items:[{id:r,name:e,quantity:1,price:o}]}),fbq("track","ViewContent",{content_name:e,content_ids:[r],content_type:"product",value:o,currency:"MXN"})),$("#myModal").modal("show")}),$("#the-products").on("click",".addToCartTable",function(t){let r=$(this).data("id"),a=$(this).data("code"),e=$(this).data("name"),o=$(this).data("price");$(this).data("img");var n=$(this).data("minqty"),i=$(this).data("storage");let l=$(".table-q-"+r).val(),d=$(".table-old-q-"+r).val();var c=l%n;let u=parseInt(l)%parseInt(n);return l<=0?(Swal.fire({title:"Cantidad Minima",html:"La cantidad debe ser mayor a 0",icon:"warning",confirmButtonColor:"#f37e2b",confirmButtonText:"Aceptar"}).then(()=>{$(".table-q-"+r).val(d)}),!1):("production"===environment&&(gtag("event","view_item",{items:[{id:r,name:e,quantity:1,price:o}]}),fbq("track","ViewContent",{content_name:e,content_ids:[r],content_type:"product",value:o,currency:"MXN"})),"N"==i&&0==c&&(u=0),0<u?(Swal.fire({title:"Producto Multiplo!",html:"De este producto solo se puede solicitar multiplos de "+n+". Ejemplo: "+ +n+", "+2*n+", "+3*n+", "+4*n+", "+5*n+" piezas.",icon:"warning",confirmButtonColor:"#f37e2b",confirmButtonText:"Aceptar"}),$("#btn-quick-purchase-"+r).html("Agregar"),$("#btn-quick-purchase-"+r).addClass("disabled"),$("#btn-quick-purchase-"+r).prop("disabled",!1),$(".table-q-"+r).focus().select(),!1):($("#btn-quick-purchase-"+r).html("Agregando..."),$("#btn-quick-purchase-"+r).addClass("disabled"),$("#btn-quick-purchase-"+r).prop("disabled",!0),void addMyCart(r,l).then(t=>{console.log(t),t.status?($("#product-btn-add-to-cart").removeClass("btn-solid"),$("#btn-quick-purchase-"+r).removeClass("btn-solid"),$("#btn-quick-purchase-"+r).addClass("btn-steal-add"),$("#btn-quick-purchase-"+r).html("<i class='fa fa-shopping-cart' style='font-size: 16px;'></i> - Agregar"),$("#btn-quick-purchase-"+r).removeClass("disabled"),$("#btn-quick-purchase-"+r).prop("disabled",!1),$(".total-items").html(t.total_items),$(".total-price").html("$ "+_formatPrice(t.data.total)),"production"===environment&&(gtag("event","add_to_cart",{items:[{id:a,name:e,list_position:1,quantity:l,price:o}]}),fbq("track","AddToCart",{content_ids:[a],content_type:"product",content_name:e,value:o,currency:"MXN"})),window.location.reload()):Swal.fire({title:"Error generado!",html:t.message,icon:"error",confirmButtonColor:"#f37e2b",confirmButtonText:"Aceptar"})}).catch(console.log)))});const getLocation=function(a){return new Promise((t,r)=>{$.ajax({url:"spages/getLocationByDirClicId",method:"get",dataType:"json",data:a}).done(t).fail(r)})},getAvailable=function(a){return new Promise((t,r)=>{$.ajax({url:"spages/shippingAvailability",method:"get",dataType:"json",data:{location_id:a,ajax:!0}}).done(t).fail(r)})},addMyCart=function(a,e){return new Promise((t,r)=>{$.ajax({url:"spages/AddToCartWithVue",method:"post",dataType:"json",data:{id:a,quantity:e}}).done(t).fail(r)})},_formatPrice=function(t){let r=(+t).toFixed(2).replace(",",".");return r.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},setCustomerSettingView=function(a,e){return new Promise((t,r)=>{$.ajax({url:`spages/updateOrCreateSettings/${a}/`+e,method:"get",dataType:"json"}).done(t).fail(r)})};